
Здесь описана архитектура сервера синхронизации.

*************
**** Модули:
****
db_interface
	Инициализирует базу данных (путем обращения к определенной реализации).
	Единственная задача - вернуть ссылку на поток, работающий с БД.
db_impl_*
	Реализация работы с БД. В функциях этого модуля работает поток, работающий с базой. Обмен данными с базой проводится путем отсылки сообщений потоку и от него. Этакий "драйвер БД". Заменив его, можно использовать другую БД.
db_impl_mnesia
	Реализация работы с базой Mnesia.

net_interface
net_impl
	Работа с сетью (аналогично работе с базой). В данный момент совершенно не продумана. 
	Цель - добиться удобной передачи сообщений от потоков сервера к клиентам и обратно.

syncserver
	Логика работы сервера. Пока тоже не продумана. 
	Предполагается, что в функциях этого модуля должны работать потоки, обменивающиеся сообщениями с клиентами (через net_) и данными с базой (через db_).

records.hrl
	Описания структур.

*************************************
**** Формат сообщений работы с базой. 
****
 {Отправитель,{действие,Пользователь,..<параметры>..}}
Поток-отправитель _обязательно_ уведомляется о результате дествия.

Действия:
	set	#запись данных пользователя по ключу
	get	#чтение данных пользователя по ключу
	erase_key #удаление данных пользователя по ключу
	create_user
	delete_user

Списки параметров для каждого действия пока не определены.

****************************************
**** Описания структур, хранящихся в БД
****
Принцип работы с базой следующий:
(user,key) -> (description,version,data)

Конкретные примеры приведены для Mnesia.
Каждому пользователю соответствует отдельная таблица. В Mnesia это по сути словарь. Ключи словаря - предположительно названия плагинов, значения - типа db_value.
-record(db_value,{description,version,data}).

В mnesia таблицы могут быть типов set, sorted_set, bag.

*****************************************
**** TODO
****
1. Определиться с логикой работы сервера.
2. Подумать над протоколом клиент-сервер.
3. Реализовать следующие части (хотя бы прототипы):
3.1 Работа с сетью.
3.2 Логика сервера.
3.3 Плагин к LeechCraft, работающий с сервером.
4. Допилить это всё до приемлемого уровня...


